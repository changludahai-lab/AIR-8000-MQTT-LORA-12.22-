<!-- è®¾å¤‡åˆ—è¡¨é¡µ -->
<view class="page">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-title">è®¾å¤‡ç®¡ç†</view>
    <view class="header-btn" bindtap="onAddDevice">+ æ·»åŠ </view>
  </view>

  <!-- ç­›é€‰ -->
  <view class="filter">
    <view 
      class="filter-item {{filterType === '' ? 'active' : ''}}"
      data-type=""
      bindtap="onFilterChange"
    >
      å…¨éƒ¨
    </view>
    <view 
      class="filter-item {{filterType === 'indoor' ? 'active' : ''}}"
      data-type="indoor"
      bindtap="onFilterChange"
    >
      å®¤å†…æœº
    </view>
    <view 
      class="filter-item {{filterType === 'outdoor' ? 'active' : ''}}"
      data-type="outdoor"
      bindtap="onFilterChange"
    >
      å®¤å¤–æœº
    </view>
  </view>

  <!-- è®¾å¤‡åˆ—è¡¨ -->
  <view class="list" wx:if="{{devices.length > 0}}">
    <view class="device-card" wx:for="{{devices}}" wx:key="id">
      <view class="device-header">
        <view class="device-imei">{{item.imei}}</view>
        <view class="device-tags">
          <view class="tag {{item.type === 'indoor' ? 'tag-info' : 'tag-warning'}}">
            {{item.type === 'indoor' ? 'å®¤å†…æœº' : 'å®¤å¤–æœº'}}
          </view>
          <view class="tag {{item.online ? 'tag-success' : 'tag-error'}}">
            {{item.online ? 'åœ¨çº¿' : 'ç¦»çº¿'}}
          </view>
        </view>
      </view>
      <view class="device-info">
        <view class="info-row">
          <text class="info-label">ç»‘å®šåŠ æ²¹ç«™:</text>
          <text class="info-value">{{item.station_name || 'æœªç»‘å®š'}}</text>
        </view>
        <view class="info-row" wx:if="{{item.last_seen}}">
          <text class="info-label">æœ€ååœ¨çº¿:</text>
          <text class="info-value">{{item.last_seen}}</text>
        </view>
        <view class="info-row" wx:if="{{item.type === 'outdoor' && item.vbat}}">
          <text class="info-label">ç”µæ± ç”µå‹:</text>
          <text class="info-value">{{item.vbat}}V</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{!loading && devices.length === 0}}">
    <view class="empty-icon">ğŸ“±</view>
    <view class="empty-text">æš‚æ— è®¾å¤‡</view>
    <view class="empty-btn" bindtap="onAddDevice">æ·»åŠ è®¾å¤‡</view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>
