import{_ as ee,r,a as M,z as te,c as h,o as m,b as u,C as ae,d as t,w as a,f as i,G as le,A as oe,j as C,g as n,l as j,F as se,H as ne,t as p,k as q,I as de,J as ie,y as ue,E as P}from"./index-N6dGGa3X.js";import{a as x}from"./index-CvrQXHFG.js";const re={class:"stations-container"},pe={class:"page-header"},ce={class:"search-bar"},me={class:"pagination-wrapper"},ve={key:1,class:"device-section"},fe={class:"device-group"},_e={class:"device-content"},ge={key:1,class:"no-device"},be={class:"device-group"},ye={class:"device-content"},Ve={key:1,class:"no-device"},he={__name:"Stations",setup(xe){const F=r([]),U=r(!1),z=r(""),g=r(!1),S=r(!1),k=r(!1),$=r(!1),B=r(null),D=r(null),d=r(null),c=M({page:1,perPage:10,total:0}),o=M({code:"",name:"",address:"",contact:"",phone:"",status:1}),A={code:[{required:!0,message:"请输入加油站编号",trigger:"blur"},{max:50,message:"编号长度不能超过50个字符",trigger:"blur"}],name:[{required:!0,message:"请输入加油站名称",trigger:"blur"},{max:100,message:"名称长度不能超过100个字符",trigger:"blur"}]};async function b(){U.value=!0;try{const e=(await x.get("/api/stations",{params:{page:c.page,per_page:c.perPage,search:z.value}})).data.data;F.value=e.items||[],c.total=e.total||0}catch{}finally{U.value=!1}}function E(){c.page=1,b()}function K(){k.value=!1,D.value=null,g.value=!0}function R(s){k.value=!0,D.value=s.id,o.code=s.code,o.name=s.name,o.address=s.address||"",o.contact=s.contact||"",o.phone=s.phone||"",o.status=s.status,g.value=!0}async function G(s){try{const e=await x.get(`/api/stations/${s.id}`);d.value=e.data.data,S.value=!0}catch{}}async function H(s){try{await ue.confirm(`确定要删除加油站 "${s.name}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await x.delete(`/api/stations/${s.id}`),P.success("删除成功"),b()}catch{}}async function J(){if(await B.value.validate().catch(()=>!1)){$.value=!0;try{const e={code:o.code,name:o.name,address:o.address,contact:o.contact,phone:o.phone,status:o.status};k.value?(await x.put(`/api/stations/${D.value}`,e),P.success("更新成功")):(await x.post("/api/stations",e),P.success("创建成功")),g.value=!1,b()}catch{}finally{$.value=!1}}}function L(){var s;o.code="",o.name="",o.address="",o.contact="",o.phone="",o.status=1,(s=B.value)==null||s.resetFields()}return te(()=>{b()}),(s,e)=>{const I=i("el-icon"),f=i("el-button"),y=i("el-input"),v=i("el-table-column"),w=i("el-tag"),O=i("el-table"),Q=i("el-pagination"),V=i("el-form-item"),W=i("el-switch"),X=i("el-form"),N=i("el-dialog"),_=i("el-descriptions-item"),Y=i("el-descriptions"),Z=oe("loading");return m(),h("div",re,[u("div",pe,[e[13]||(e[13]=u("h2",null,"加油站管理",-1)),t(f,{type:"primary",onClick:K},{default:a(()=>[t(I,null,{default:a(()=>[t(j(se))]),_:1}),e[12]||(e[12]=n(" 新增加油站 ",-1))]),_:1})]),u("div",ce,[t(y,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=l=>z.value=l),placeholder:"搜索加油站名称或编号",clearable:"",style:{width:"300px"},onKeyup:le(E,["enter"]),onClear:E},{prefix:a(()=>[t(I,null,{default:a(()=>[t(j(ne))]),_:1})]),_:1},8,["modelValue"]),t(f,{type:"primary",onClick:E},{default:a(()=>[...e[14]||(e[14]=[n("搜索",-1)])]),_:1})]),ae((m(),C(O,{data:F.value,stripe:""},{default:a(()=>[t(v,{prop:"id",label:"ID",width:"80"}),t(v,{prop:"code",label:"编号",width:"120"}),t(v,{prop:"name",label:"名称","min-width":"150"}),t(v,{prop:"address",label:"地址","min-width":"200","show-overflow-tooltip":""}),t(v,{prop:"contact",label:"联系人",width:"100"}),t(v,{prop:"phone",label:"联系电话",width:"130"}),t(v,{prop:"status",label:"状态",width:"80"},{default:a(({row:l})=>[t(w,{type:l.status===1?"success":"danger"},{default:a(()=>[n(p(l.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(v,{label:"操作",width:"200",fixed:"right"},{default:a(({row:l})=>[t(f,{type:"primary",text:"",size:"small",onClick:T=>G(l)},{default:a(()=>[...e[15]||(e[15]=[n(" 详情 ",-1)])]),_:1},8,["onClick"]),t(f,{type:"primary",text:"",size:"small",onClick:T=>R(l)},{default:a(()=>[...e[16]||(e[16]=[n(" 编辑 ",-1)])]),_:1},8,["onClick"]),t(f,{type:"danger",text:"",size:"small",onClick:T=>H(l)},{default:a(()=>[...e[17]||(e[17]=[n(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,U.value]]),u("div",me,[t(Q,{"current-page":c.page,"onUpdate:currentPage":e[1]||(e[1]=l=>c.page=l),"page-size":c.perPage,"onUpdate:pageSize":e[2]||(e[2]=l=>c.perPage=l),"page-sizes":[10,20,50,100],total:c.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:b,onCurrentChange:b},null,8,["current-page","page-size","total"])]),t(N,{modelValue:g.value,"onUpdate:modelValue":e[10]||(e[10]=l=>g.value=l),title:k.value?"编辑加油站":"新增加油站",width:"550px",onClose:L},{footer:a(()=>[t(f,{onClick:e[9]||(e[9]=l=>g.value=!1)},{default:a(()=>[...e[18]||(e[18]=[n("取消",-1)])]),_:1}),t(f,{type:"primary",loading:$.value,onClick:J},{default:a(()=>[...e[19]||(e[19]=[n(" 确定 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[t(X,{ref_key:"formRef",ref:B,model:o,rules:A,"label-width":"100px"},{default:a(()=>[t(V,{label:"加油站编号",prop:"code"},{default:a(()=>[t(y,{modelValue:o.code,"onUpdate:modelValue":e[3]||(e[3]=l=>o.code=l),placeholder:"请输入加油站编号"},null,8,["modelValue"])]),_:1}),t(V,{label:"加油站名称",prop:"name"},{default:a(()=>[t(y,{modelValue:o.name,"onUpdate:modelValue":e[4]||(e[4]=l=>o.name=l),placeholder:"请输入加油站名称"},null,8,["modelValue"])]),_:1}),t(V,{label:"地址",prop:"address"},{default:a(()=>[t(y,{modelValue:o.address,"onUpdate:modelValue":e[5]||(e[5]=l=>o.address=l),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1}),t(V,{label:"联系人",prop:"contact"},{default:a(()=>[t(y,{modelValue:o.contact,"onUpdate:modelValue":e[6]||(e[6]=l=>o.contact=l),placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1}),t(V,{label:"联系电话",prop:"phone"},{default:a(()=>[t(y,{modelValue:o.phone,"onUpdate:modelValue":e[7]||(e[7]=l=>o.phone=l),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),t(V,{label:"状态",prop:"status"},{default:a(()=>[t(W,{modelValue:o.status,"onUpdate:modelValue":e[8]||(e[8]=l=>o.status=l),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(N,{modelValue:S.value,"onUpdate:modelValue":e[11]||(e[11]=l=>S.value=l),title:"加油站详情",width:"650px"},{default:a(()=>[d.value?(m(),C(Y,{key:0,column:2,border:""},{default:a(()=>[t(_,{label:"编号"},{default:a(()=>[n(p(d.value.code),1)]),_:1}),t(_,{label:"名称"},{default:a(()=>[n(p(d.value.name),1)]),_:1}),t(_,{label:"地址",span:2},{default:a(()=>[n(p(d.value.address||"-"),1)]),_:1}),t(_,{label:"联系人"},{default:a(()=>[n(p(d.value.contact||"-"),1)]),_:1}),t(_,{label:"联系电话"},{default:a(()=>[n(p(d.value.phone||"-"),1)]),_:1}),t(_,{label:"状态"},{default:a(()=>[t(w,{type:d.value.status===1?"success":"danger"},{default:a(()=>[n(p(d.value.status===1?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"创建时间"},{default:a(()=>[n(p(d.value.created_at),1)]),_:1})]),_:1})):q("",!0),d.value?(m(),h("div",ve,[e[22]||(e[22]=u("h4",null,"绑定设备",-1)),u("div",fe,[e[20]||(e[20]=u("div",{class:"device-label"},"室内机：",-1)),u("div",_e,[d.value.indoor_device?(m(),C(w,{key:0,type:"success"},{default:a(()=>[n(p(d.value.indoor_device.imei),1)]),_:1})):(m(),h("span",ge,"未绑定"))])]),u("div",be,[e[21]||(e[21]=u("div",{class:"device-label"},"室外机：",-1)),u("div",ye,[d.value.outdoor_devices&&d.value.outdoor_devices.length>0?(m(!0),h(de,{key:0},ie(d.value.outdoor_devices,l=>(m(),C(w,{key:l.imei,type:"warning",style:{"margin-right":"8px","margin-bottom":"4px"}},{default:a(()=>[n(p(l.imei),1)]),_:2},1024))),128)):(m(),h("span",Ve,"未绑定"))])])])):q("",!0)]),_:1},8,["modelValue"])])}}},Ce=ee(he,[["__scopeId","data-v-9df20631"]]);export{Ce as default};
