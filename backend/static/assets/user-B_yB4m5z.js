import{T as v,r,i as u}from"./index-CjpewyOQ.js";import{a as n}from"./index-DPVtAufC.js";const k=v("user",()=>{const t=r(null),a=r(localStorage.getItem("token")||""),l=u(()=>!!a.value),s=u(()=>{var e;return((e=t.value)==null?void 0:e.role)==="admin"});async function c(e,p){const o=(await n.post("/api/auth/login",{username:e,password:p})).data;return a.value=o.data.token,t.value=o.data.user,localStorage.setItem("token",o.data.token),o}async function i(){try{await n.post("/api/auth/logout")}catch{}a.value="",t.value=null,localStorage.removeItem("token")}async function m(){if(!a.value)return null;try{const e=await n.get("/api/auth/me");return t.value=e.data.data,t.value}catch{return a.value="",t.value=null,localStorage.removeItem("token"),null}}return{user:t,token:a,isLoggedIn:l,isAdmin:s,login:c,logout:i,fetchCurrentUser:m}});export{k as useUserStore};
