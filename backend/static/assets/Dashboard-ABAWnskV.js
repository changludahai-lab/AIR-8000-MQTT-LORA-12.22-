import{_ as D,r as B,a as z,z as N,c as b,o as v,b as s,d as t,w as a,f as n,u as V,A as I,l as u,n as E,t as c,p as M,B as S,C as T,k as j,j as R,g as p,D as q}from"./index-BCm-iu0U.js";import{a as F}from"./index-D-6YZA5Z.js";const G={class:"dashboard-container"},H={class:"stat-content"},J={class:"stat-icon station-icon"},K={class:"stat-info"},L={class:"stat-value"},O={class:"stat-content"},P={class:"stat-icon device-icon"},Q={class:"stat-info"},U={class:"stat-value"},W={class:"stat-content"},X={class:"stat-icon online-icon"},Y={class:"stat-info"},Z={class:"stat-value"},$={class:"card-header"},tt={key:0,class:"empty-tip"},at={__name:"Dashboard",setup(st){const w=V(),i=B(!1),o=z({stationCount:0,deviceCount:0,onlineCount:0,recentAlarms:[]});async function g(){i.value=!0;try{const e=(await F.get("/api/stations/stats")).data.data;o.stationCount=e.station_count||0,o.deviceCount=e.device_count||0,o.onlineCount=e.online_count||0,o.recentAlarms=e.recent_alarms||[]}catch{}finally{i.value=!1}}function y(){w.push("/alarms")}return N(()=>{g()}),(m,e)=>{const _=n("el-icon"),r=n("el-card"),f=n("el-col"),C=n("el-row"),k=n("el-button"),d=n("el-table-column"),h=n("el-tag"),x=n("el-table"),A=I("loading");return v(),b("div",G,[e[5]||(e[5]=s("div",{class:"page-header"},[s("h2",null,"首页仪表盘")],-1)),t(C,{gutter:20,class:"stats-row"},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(r,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",H,[s("div",J,[t(_,{size:32},{default:a(()=>[t(u(E))]),_:1})]),s("div",K,[s("div",L,c(o.stationCount),1),e[0]||(e[0]=s("div",{class:"stat-label"},"加油站总数",-1))])])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(r,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",O,[s("div",P,[t(_,{size:32},{default:a(()=>[t(u(M))]),_:1})]),s("div",Q,[s("div",U,c(o.deviceCount),1),e[1]||(e[1]=s("div",{class:"stat-label"},"设备总数",-1))])])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(r,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",W,[s("div",X,[t(_,{size:32},{default:a(()=>[t(u(S))]),_:1})]),s("div",Y,[s("div",Z,c(o.onlineCount),1),e[2]||(e[2]=s("div",{class:"stat-label"},"在线设备数",-1))])])]),_:1})]),_:1})]),_:1}),t(r,{class:"alarm-card",shadow:"hover"},{header:a(()=>[s("div",$,[e[4]||(e[4]=s("span",null,"最近报警记录",-1)),t(k,{type:"primary",text:"",onClick:y},{default:a(()=>[e[3]||(e[3]=p(" 查看全部 ",-1)),t(_,null,{default:a(()=>[t(u(q))]),_:1})]),_:1})])]),default:a(()=>[T((v(),R(x,{data:o.recentAlarms,stripe:""},{default:a(()=>[t(d,{prop:"created_at",label:"时间",width:"180"}),t(d,{prop:"station_name",label:"加油站","min-width":"150"},{default:a(({row:l})=>[p(c(l.station_name||"-"),1)]),_:1}),t(d,{prop:"indoor_imei",label:"室内机IMEI",width:"160"}),t(d,{prop:"alarm_type",label:"类型",width:"100"},{default:a(({row:l})=>[t(h,{type:l.alarm_type==="alarm"?"danger":"success"},{default:a(()=>[p(c(l.alarm_type==="alarm"?"报警":"取消"),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"forward_status",label:"转发状态",width:"100"},{default:a(({row:l})=>[t(h,{type:l.forward_status===1?"success":"warning"},{default:a(()=>[p(c(l.forward_status===1?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[A,i.value]]),!i.value&&o.recentAlarms.length===0?(v(),b("div",tt," 暂无报警记录 ")):j("",!0)]),_:1})])}}},nt=D(at,[["__scopeId","data-v-4ba6a26b"]]);export{nt as default};
